Решал с использованием алгоритма Дейкстры. 
